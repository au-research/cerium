# Test in memory
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driverClassName=org.h2.Driver
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.h2.console.enabled=false
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.properties.hibernate.format_sql=false

# cache
spring.cache.type=simple

# avoid LazyInitializationException,
# open a temporary Session when no active Session is available to initialize the lazily fetched association
# could increase overall load to the database but enable use of LazyLoading
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true
spring.jpa.open-in-view=false

app.data-path=/tmp/integration-test-drvs-registry/

# during testing, disable automatic creating worker threads
app.igsn.disable-automatic-queue-worker-init=false

# allow error message to appear in HTTP response, default to never
server.error.include-message=always

# batch
spring.batch.initialize-schema=ALWAYS
spring.batch.job.enabled=false

# actuators
management.endpoints.web.exposure.include=health, info, metrics
management.endpoint.metrics.enabled=true

# keycloak integration test configuration
keycloak.enabled=true
keycloak.realm=ARDC
keycloak.auth-server-url=https://test.auth.ardc.edu.au/auth
keycloak.ssl-required=external
keycloak.resource=test-drvs-registry
keycloak.credentials.secret=6f3e961d-07b6-4438-8bce-9aa6d699dd70
keycloak.enable-basic-auth=true
keycloak.cors=false
keycloak.bearer-only=true

# IGSN_USER role required to /api/resources/* and /api/me/
keycloak.security-constraints[0].authRoles[0]=DRVS_USER
keycloak.security-constraints[0].securityCollections[0].patterns[0]=/api/resources/*
keycloak.security-constraints[0].securityCollections[0].patterns[1]=/api/me/
keycloak.security-constraints[0].securityCollections[0].patterns[2]=/api/services/auth-check/
keycloak.security-constraints[0].securityCollections[0].patterns[3]=/api/services/drvs/*
keycloak.security-constraints[1].authRoles[0]=DRVS_ADMIN
keycloak.security-constraints[1].securityCollections[0].patterns[0]=/api/admin/*

# token url for swagger interface
keycloak-token-url=${keycloak.auth-server-url}/realms/${keycloak.realm}/protocol/openid-connect/token

# keycloak admin credentials, used for groups & resource resolving
keycloak-admin.username=igsn-admin
keycloak-admin.password=sv3qQh1Fqegb

# keycloak integration test user
test.kc.user.id=33e4cf8b-fd8f-4677-bcaa-61b1aa68af00
test.kc.user.username=testuser9@ardc.edu.au
test.kc.user.password=IticALDEcTICTmat
test.kc.user.rsid=6f49827b-217b-438b-aae9-2b7046a3a712

# keycloak integration test admin user
test.kc.admin.username=testuser11@ardc.edu.au
test.kc.admin.password=ArYMPHysTaGErtIO

# mds
mds.enabled=false